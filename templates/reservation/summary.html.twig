{% extends 'base.html.twig' %}

{% block title %}reservation{% endblock %}

{% block content %}

{% set nbtravelers = reservation.travelers | length %}
{% set nboptions = reservation.options | length %}
    <div class="container">
    <h1 class= "center-align mt-1">{% trans %} Summary of your trip {% endtrans %}</h1>
    
    <div class="divmg mt-1">
        <img class="img-100pc" src="/images/cocktail.jpg" alt="Options_travel">
    </div>
    <div class="row">
    <div class="col l6 center-align">
    <strong>{{ nbtravelers}} 
        {% if nbtravelers > 1 %}Voyageurs 
        {% else %} Voyageur {% endif %}
    </strong>
    <br>
    <strong>{{ nboptions }} 
        {% if nboptions > 1 %}Options 
        {% else %} option {% endif %}
    </strong>
    </div>
    <div class="col l6 center-align grey lighten-3">
        <span> {% trans %} Total {% endtrans %} </span>
        <div class="price">
        {{ totalPrice }}€ 
        </div> 
    </div>
    </div>
    <h2 class= "center-align mt-1">{% trans %} Your travel {% endtrans %}</h2>
    <table class="centered">
        <thead>
          <tr>
              <th colspan= 2>Destination</th>
              <th>{% trans %} Depature {% endtrans %}</th>
              <th>{% trans %} Arrival {% endtrans %}</th>
          </tr>
        </thead>
        <tbody>
        {% for stay in reservation.stays %}
        <tr>
            <td>{{ stay.travel.name }}</td>
            <td>{{ stay.travel.subtitle }}</td>
            <td>{{ stay.starDate | date("d/m/Y") }}</td>
            <td>{{ stay.endDate | date("d/m/Y") }}</td>
        </tr>
        {% endfor %}
        </tbody>
      </table>

    <h2 class= "center-align mt-1">{% trans %} The travelers {% endtrans %}</h2>
    <table>
        <thead>
          <tr>
            <th></th>
            <th>{% trans %} Lastname {% endtrans %}</th>
            <th>{% trans %} Firstname {% endtrans %}</th>
            <th>Email</th>
            <th>{% trans %} Birthday {% endtrans %}</th>
          </tr>
        </thead>

        <tbody>
          {% for traveler in reservation.travelers %}
          <tr>
            <td> {% trans %} Travelers {% endtrans %}{{ loop.index }}</td>
            <td>{{ traveler.lastname }}</td>
            <td>{{ traveler.firstname }}</td>
            <td>{{ traveler.email }}</td>
            <td>{{ traveler.birthday | date("d/m/Y") }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% if reservation.options %}
    <h2 class= "center-align mt-1">{% trans %} Your options {% endtrans %}</h2>
    <table class="centered">
        <thead>
          <tr>
                <th></th>
                <th>Option</th>
                <th>Description</th>
                <th>{% trans %} Full cost {% endtrans %}</th>
          </tr>
        </thead>

        <tbody>
          {% for option in reservation.options %}
          <tr>
            <td> Option {{ loop.index }}</td>
            <td>{{ option.name }}</td>
            <td>{{ option.description | raw }}</td>
            <td>{{ option.price * ( nbtravelers) }} €</td>
          </tr>
          {% endfor %}
          <tr>
          <td> {% trans %} Full cost {% endtrans %}</td>
          <td colspan = 2></td>
          <td > <strong>{{ totalPriceOptions }} €</strong></td>
          </tr>
        </tbody>
      </table>
      <div class="pad">
        <div class="right-align">
            <a class="btn waves-effect waves-light" href="{{ path('traveler_configure', {'id': reservation.stays[0].id}) }}">{% trans %} Preview {% endtrans %}
                <i class="material-icons left">keyboard_arrow_left</i>
            </a>
            <a class="waves-effect waves-light btn red darken-4 text-white" href="{{ path('reservation_remove') }}">{% trans %} Remove {% endtrans %}
            </a>

            <a class="waves-effect waves-light btn modal-trigger" href="#modal1">{% trans %} Validate {% endtrans %}

                <i class="material-icons right">keyboard_arrow_right</i>
            </a>

        </div>
      </div>

  <!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>{% trans %} Your reservation {% endtrans %}</h4>
        <p> Avant le paiement de votre réservation, il est important de vérifier les informations 
            que vous nous avez fourni, une fois le voyage validé, vous ne pourrez plus les modifier. </p>
    </div>
    <div class="modal-footer">
        <a class="blue darken-2 waves-effect waves-light btn modal-close">{% trans %} Check {% endtrans %}
            <i class="material-icons right">check</i>
        </a>
        <a type="submit" href="{{ path('reservation_validate') }}" class="waves-effect waves-light btn" name="action">{% trans %} Paid {% endtrans %}
            <i class="material-icons right">keyboard_arrow_right</i>
        </a>
    </div>
  </div>
    {% endif %}
{% endblock %}